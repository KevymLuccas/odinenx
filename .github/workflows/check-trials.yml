name: Check Trial Expiration Daily

on:
  schedule:
    # Executa todo dia √†s 00:00 UTC (21:00 Brasil)
    - cron: '0 0 * * *'
  workflow_dispatch: # Permite execu√ß√£o manual

jobs:
  check-trials:
    runs-on: ubuntu-latest
    
    steps:
      - name: Check Trial Expiration
        run: |
          echo "üîç Verificando trials expirados..."
          
          # Chamar Edge Function do Supabase
          curl -X POST \
            -H "Authorization: Bearer ${{ secrets.SUPABASE_ANON_KEY }}" \
            -H "Content-Type: application/json" \
            https://mzamszcpbverpadjelck.supabase.co/functions/v1/check-trial
          
          echo "‚úÖ Verifica√ß√£o conclu√≠da!"

      - name: Log Results
        run: |
          echo "üìä Trial check executado em $(date)"
          echo "üåê Logs dispon√≠veis no Supabase Dashboard"